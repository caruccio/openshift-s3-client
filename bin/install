#!/bin/bash -eu

case "$1" in
	-v|--version)
		version="$2"
esac

source versions/${version:-0.0.1}/bin/request-s3-credentials

if create-s3-iam-user; then
	echo "ENV_VAR_ADD OPENSHIFT_AWS_ACCESS_KEY_ID=$AWS_ACCESS_KEY_ID"
	echo "ENV_VAR_ADD OPENSHIFT_AWS_SECRET_ACCESS_KEY=$AWS_SECRET_ACCESS_KEY"
	echo "ENV_VAR_ADD OPENSHIFT_AWS_BUCKET_NAME=$AWS_BUCKET_NAME"

	cat <<-EOF
		Your AWS S3 credentials:

		OPENSHIFT_AWS_ACCESS_KEY_ID:     $AWS_ACCESS_KEY_ID
		OPENSHIFT_AWS_SECRET_ACCESS_KEY: $AWS_SECRET_ACCESS_KEY
		OPENSHIFT_AWS_BUCKET_NAME:       $AWS_BUCKET_NAME
	EOF
fi
